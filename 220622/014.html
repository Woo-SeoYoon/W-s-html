<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <!-- Bootstrap framework - css / js -->
    <!-- 한마디로 정리하면 웹사이트 개발 프레임워크다.
        그렇다면 프레임워크란 뭘까?
        프레임워크는 영어로는 FrameWork로
        한국어로 쉽게 도우미라고 생각하면 된다.
        즉, 부트스트랩은 HTML, CSS, JS 도우미다.-->내가할수있음 
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
        
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&display=swap" rel="stylesheet">
          
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    
        <title>날씨앱 3단계 함수</title>
        <style>
            body {
        
            background: url(https://images.unsplash.com/photo-1558486012-817176f84c6d?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=670&q=80);
            background-repeat: no-repeat;
            background-size: cover;
           }
            #app {
                font-family: 'Nanum Gothic', '맑은 고딕', sans-serif;
                display: flex;
                justify-content: center;
                flex-direction: column;
                align-items: center;
                text-align: center;
                font-weight: bold;
                font-size: large;
                color: black;
                height: 100vh;
            }
            #app h1 {
               margin: 50px;
               color: cornflowerblue;
            }
            .btnGroup {
                margin: 50px;
            }
            #weatherInfo {
                border: 3px solid black;
                border-radius: 20px;
                background-color: rgba(240, 247, 255, 0.3);
                width: 300px;
                padding: 10px;
            }
        </style>
</head>
<body>
    <script>
        //1. 인천, 서울 ,부산 배열을 만들고 버튼을 출력하시오
        //2. 도시를 선택하면 위도와 경도를 얻어오시오
        //3. 날씨와 공기정보를 얻어와 객체를 생성해 출력하시오
        const cities =[{name:'서울', code:'Seoul'},
        {name:'부산', code:'Busan'},
        {name:'인천', code:'Incheon'}
         ];
        function init(){
             const $target = $('#target');
             cities.forEach((city,i)=>{
                 $('<button>').text(city.name).attr('data-cno',i).appendTo($target);
             })
         }
         $(document).ready(function(){
             const $target = $('#target');
             cities.forEach((city,i)=>{
                 $('<button>').text(city.name).attr('data-cno',i).appendTo($target)
             })
         })



        function changeCity(){

        }


        let 우서윤날씨=null;
        const key= '4e96bbe63437be4054581d930fdd2021';
        const city= 'Incheon';
       const url =  `http://api.openweathermap.org/geo/1.0/direct?q=${city}&limit=5&appid=${key}`;

        async function getPosition(){
                const result=  await $.ajax(url);
                위도 = result[0].lat;
                경도 = result[0].lon;
                console.log(위도,경도)
        }
    
        function getFormatDate(date) {
            //날짜를 '6월20일'
            return `${date.getMonth()+1}월${date.getDate()}일`;
        }

        function getFormatTime(date) {
            //시간을 '07:20'
            return `${date.getHours()}:${date.getMinutes()}`;
        }
        
        async function getWeather() {
            const url = `https://api.openweathermap.org/data/2.5/onecall?lat=${위도}&lon=${경도}&appid=${key}&units=metric`; 
            const result = await $.ajax(url);
            const 일출 = new Date(result.current.sunrise*1000);
            const 일몰 = new Date(result.current.sunset*1000);
            const 온도 = result.current.temp;
            const 습도 = result.current.humidity;

            const 최저 = result.daily[0].temp.min;
            const 최고 = result.daily[0].temp.max;
            const 체감 = result.current.feels_like;
            const 자외선 = result.current.uvi;
            // ES6 구조분해할당 : 이름과 값을 가진 변수가 똑같은 경우 한번만 적는다
            const 상태 = result.current.weather[0].main;
            const 예보 = [];
            
            //날씨 예보(result.daily)에서 내일과 모레의 날짜, 상태, 최고온도를 꺼내온다.
            //daily가 0부터 시작해서? i=1로 한듯
            for(let i=1; i<=7; i++) {
               const sunrise = new Date(result.daily[i].sunrise*1000)
               const 날짜 = getFormatDate(sunrise);
               const 일출 = getFormatTime(sunrise);
               const 상태 = result.daily[i].weather[0].main;
               예보[i-1] = {날짜, 일출, 상태};
               console.log(날짜);
            }

            날씨 = {일출, 일몰, 온도, 습도, 최저, 최고, 체감, 자외선, 상태, 예보};
            console.log(날씨);
        }
    

    $(document).ready(async function() {
        await getPosition();
        await getWeather();
    });
  
        function printWeather(){

        }




 /*
 const ar=[{},{}];

        const cno = 0;
        const ar.name[cno]
    */
    </script>
    <div id="target">

    </div>


    <body>
        <div id="app">
            <h1>Weather⛅</h1>
            <div id="weatherInfo">
                <div id="name"></div>
                <div id="temp"></div>
                <div id="cloud"></div>
            </div>
            <div id="buttons" class="btnGroup">
                <!-- 요소에 값을 저장할 때는 data- 속성을 사용한다 -->
               <!--
                // 부트스트랩 버튼 양식 근데 이거 주석처리했는데
                    버튼 어떻게 생기는거지???? 
                <button type="button" class="btn btn-primary" data-city="Incheon">인천</button>
                <button type="button" class="btn btn-primary" data-city="Seoul">서울</button>
                <button type="button" class="btn btn-primary" data-city="Busan">부산</button>
                <button type="button" class="btn btn-primary" data-city="Tokyo">도쿄</button>
                <button type="button" class="btn btn-primary" data-city="New York">뉴욕</button>
                -->
            </div>
        </div>
    </body>
    </html>
</body>
</html>